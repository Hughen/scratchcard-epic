!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ScratchCardEpic=e():t.ScratchCardEpic=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){(function(e){var n="Expected a function",i=NaN,r="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,h=parseInt,u="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,d=u||l||Function("return this")(),f=Object.prototype.toString,p=Math.max,v=Math.min,m=function(){return d.Date.now()};function b(t,e,i){var r,o,s,a,c,h,u=0,l=!1,d=!1,f=!0;if("function"!=typeof t)throw new TypeError(n);function b(e){var n=r,i=o;return r=o=void 0,u=e,a=t.apply(i,n)}function w(t){var n=t-h;return void 0===h||n>=e||n<0||d&&t-u>=s}function M(){var t=m();if(w(t))return x(t);c=setTimeout(M,function(t){var n=e-(t-h);return d?v(n,s-(t-u)):n}(t))}function x(t){return c=void 0,f&&r?b(t):(r=o=void 0,a)}function E(){var t=m(),n=w(t);if(r=arguments,o=this,h=t,n){if(void 0===c)return function(t){return u=t,c=setTimeout(M,e),l?b(t):a}(h);if(d)return c=setTimeout(M,e),b(h)}return void 0===c&&(c=setTimeout(M,e)),a}return e=y(e)||0,g(i)&&(l=!!i.leading,s=(d="maxWait"in i)?p(y(i.maxWait)||0,e):s,f="trailing"in i?!!i.trailing:f),E.cancel=function(){void 0!==c&&clearTimeout(c),u=0,r=h=o=c=void 0},E.flush=function(){return void 0===c?a:x(m())},E}function g(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function y(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&f.call(t)==r}(t))return i;if(g(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=g(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=a.test(t);return n||c.test(t)?h(t.slice(2),n?2:8):s.test(t)?i:+t}t.exports=function(t,e,i){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError(n);return g(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),b(t,e,{leading:r,maxWait:e,trailing:o})}}).call(this,n(1))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){var n=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some(function(t,i){return t[0]===e&&(n=i,!0)}),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(e,n){var i=t(this.__entries__,e);~i?this.__entries__[i][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,i=t(n,e);~i&&n.splice(i,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,i=this.__entries__;n<i.length;n++){var r=i[n];t.call(e,r[1],r[0])}},e}()}(),i="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),o="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)},s=2;var a=20,c=["top","right","bottom","left","width","height","size","weight"],h="undefined"!=typeof MutationObserver,u=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,i=!1,r=0;function a(){n&&(n=!1,t()),i&&h()}function c(){o(a)}function h(){var t=Date.now();if(n){if(t-r<s)return;i=!0}else n=!0,i=!1,setTimeout(c,e);r=t}return h}(this.refresh.bind(this),a)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return t.forEach(function(t){return t.broadcastActive()}),t.length>0},t.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),h?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;c.some(function(t){return!!~n.indexOf(t)})&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),l=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},d=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||r},f=y(0,0,0,0);function p(t){return parseFloat(t)||0}function v(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(e,n){return e+p(t["border-"+n+"-width"])},0)}function m(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return f;var i=d(t).getComputedStyle(t),r=function(t){for(var e={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var r=i[n],o=t["padding-"+r];e[r]=p(o)}return e}(i),o=r.left+r.right,s=r.top+r.bottom,a=p(i.width),c=p(i.height);if("border-box"===i.boxSizing&&(Math.round(a+o)!==e&&(a-=v(i,"left","right")+o),Math.round(c+s)!==n&&(c-=v(i,"top","bottom")+s)),!function(t){return t===d(t).document.documentElement}(t)){var h=Math.round(a+o)-e,u=Math.round(c+s)-n;1!==Math.abs(h)&&(a-=h),1!==Math.abs(u)&&(c-=u)}return y(r.left,r.top,a,c)}var b="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof d(t).SVGGraphicsElement}:function(t){return t instanceof d(t).SVGElement&&"function"==typeof t.getBBox};function g(t){return i?b(t)?function(t){var e=t.getBBox();return y(0,0,e.width,e.height)}(t):m(t):f}function y(t,e,n,i){return{x:t,y:e,width:n,height:i}}var w=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=y(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=g(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),M=function(){return function(t,e){var n,i,r,o,s,a,c,h=(i=(n=e).x,r=n.y,o=n.width,s=n.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(a.prototype),l(c,{x:i,y:r,width:o,height:s,top:r,right:i+o,bottom:s+r,left:i}),c);l(this,{target:t,contentRect:h})}}(),x=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new n,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof d(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new w(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof d(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map(function(t){return new M(t.target,t.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),E="undefined"!=typeof WeakMap?new WeakMap:new n,A=function(){return function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=u.getInstance(),i=new x(e,n,this);E.set(this,i)}}();["observe","unobserve","disconnect"].forEach(function(t){A.prototype[t]=function(){var e;return(e=E.get(this))[t].apply(e,arguments)}});var L=void 0!==r.ResizeObserver?r.ResizeObserver:A;e.a=L}).call(this,n(1))},function(t,e,n){var i=n(4);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(5)(!1)).push([t.i,".scratchcard-menu-wrapper {\n    position: absolute;\n    z-index: 1050;\n    display: block;\n    font-size: 14px;\n    line-height: 1.5;\n    list-style: none;\n    left: 99999px;\n    top: 99999px;\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n.scratchcard-menu-hidden {\n    display: none;\n}\n\n.scratchcard-menu-root {\n    position: relative;\n    margin: 0;\n    padding: 4px 0;\n    text-align: left;\n    list-style-type: none;\n    background-color: #fff;\n    background-clip: padding-box;\n    border-radius: 4px;\n    outline: none;\n    -webkit-box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n    min-width: 180px;\n}\n\nul.scratchcard-menu-root {\n    list-style: none;\n}\n\n.scratchcard-menu-item {\n    clear: both;\n    margin: 0;\n    padding: 5px 12px;\n    color: rgba(0, 0, 0, 0.78);\n    font-weight: normal;\n    font-size: 14px;\n    white-space: nowrap;\n    cursor: pointer;\n    transition: all 0.3s;\n    user-select: none;\n}\n\n.scratchcard-menu-item:hover {\n    background-color: #e6f7ff;\n}\n\n.scratchcard-menu-item.disabled {\n    color: #9c9c9c;\n    cursor: not-allowed;\n}\n\n.scratchcard-menu-item.disabled:hover {\n    background-color: transparent;\n}\n\n.scratchcard-content {\n    user-select: none !important;\n    pointer-events: none !important;\n}\n\n.scratchcard-menu-item-shortcut {\n    float: right;\n}\n",""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=(s=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),o=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[n].concat(o).concat([r]).join("\n")}var s;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];null!=o&&(i[o]=!0)}for(r=0;r<t.length;r++){var s=t[r];null!=s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(t,e,n){var i,r,o={},s=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),a=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),c=null,h=0,u=[],l=n(7);function d(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=o[i.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](i.parts[s]);for(;s<i.parts.length;s++)r.parts.push(g(i.parts[s],e))}else{var a=[];for(s=0;s<i.parts.length;s++)a.push(g(i.parts[s],e));o[i.id]={id:i.id,refs:1,parts:a}}}}function f(t,e){for(var n=[],i={},r=0;r<t.length;r++){var o=t[r],s=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};i[s]?i[s].parts.push(a):n.push(i[s]={id:s,parts:[a]})}return n}function p(t,e){var n=a(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=u[u.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),u.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=a(t.insertAt.before,n);n.insertBefore(e,r)}}function v(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function m(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return b(e,t.attrs),p(t,e),e}function b(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function g(t,e){var n,i,r,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var s=h++;n=c||(c=m(e)),i=M.bind(null,n,s,!1),r=M.bind(null,n,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",b(e,t.attrs),p(t,e),e}(e),i=function(t,e,n){var i=n.css,r=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(i=l(i));r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([i],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,n,e),r=function(){v(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(e),i=function(t,e){var n=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){v(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=f(t,e);return d(n,e),function(t){for(var i=[],r=0;r<n.length;r++){var s=n[r];(a=o[s.id]).refs--,i.push(a)}t&&d(f(t,e),e);for(r=0;r<i.length;r++){var a;if(0===(a=i[r]).refs){for(var c=0;c<a.parts.length;c++)a.parts[c]();delete o[a.id]}}}};var y,w=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function M(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=w(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),o=n(2);function s(t){if("number"==typeof t)return`${t}px`;return isNaN(1*t)?"string"!=typeof t?"":/px|em|rem$/i.test(t)?t:t.replace(/[^\d\.]+/,"")+"px":`${t}px`}function a(t){let e={top:0,left:0};if(!(t instanceof HTMLElement))return e;const n=t.getBoundingClientRect();for(;t;)e.top+=t.offsetTop,e.left+=t.offsetLeft,t=t.offsetParent;const i=e.top-n.top,r=e.left-n.left;return{top:i<0?e.top+Math.abs(i):e.top-Math.abs(i),left:r<0?e.left+Math.abs(r):e.left-Math.abs(r)}}function c(t){return"string"==typeof t&&(e=t,!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)||-1!==t.indexOf("/"));var e}function h(t){return new Promise((e,n)=>{const i=new Image;i.crossOrigin="",i.onload=(()=>{e(i)}),i.onerror=(()=>{n(new Error(`The image ${t} can not be loaded.`))}),i.src=t})}function u(){return/Android|webOS|iPhone|iPad|iPod|Opera Mini/i.test(navigator.userAgent)}function l(t){if(t.buttons&&1!==t.buttons)return 2;return 1!==(t.which||t.button)?2:1}const d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFwmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxNy0xMi0zMVQyMjo1OTozNyswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxNy0xMi0zMVQyMjo1OTozNyswMTowMCIgeG1wOk1vZGlmeURhdGU9IjIwMTctMTItMzFUMjI6NTk6MzcrMDE6MDAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzhmNTE3OTUtZTA1My1lMjQ5LTkwMjYtN2IwNTRkZDI4NDhjIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YzNjMzRmNjgtYTljYi00MzQ3LWFiOWUtZWVh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";class f{constructor(t,e){this.px=0,this.py=0,this.ctx=t,this.brushImage=e||this.getDefaultBrush()}moveBrushPos(t,e){this.px=t,this.py=e}brush(){const t=Math.atan2(this.px,this.py);this.ctx.translate(this.px,this.py),this.ctx.rotate(t),this.ctx.drawImage(this.brushImage,-this.brushImage.width/2,-this.brushImage.height/2)}getDefaultBrush(){const t=new Image;return t.alt="",t.src=d,t}}n(3);const p="scratchcard-menu";class v{constructor(t,e,n){this.remove=(()=>{this.removeEvent(),this.menuList&&(this.menuList.remove(),this.dropdownDiv.remove(),this.topDiv.remove()),this.menuList=null,this.menuData=[]}),this.reCreateMenu=(t=>{this.remove(),this.menuData=t||[],this.createMenuElement(),this.loadToHtml(),this.initEvent()}),this.move=((t,e)=>{this.dropdownDiv.style.left=`${t}px`,this.dropdownDiv.style.top=`${e}px`}),this.hide=(()=>{this.menuData.length&&this.dropdownDiv.classList.add(`${p}-hidden`)}),this.show=(()=>{this.menuData.length&&this.dropdownDiv.classList.remove(`${p}-hidden`)}),this.handleWindowClick=(t=>{if(this.menuList){if(t.target){const e=t.target.classList;if(e.contains(`${p}-item`)&&e.contains("disabled"))return}this.hide()}}),this.handleContextMenu=((t,e)=>{if(e)return!this.menuList&&this.pointerInClient(t)&&t.preventDefault(),void this.hide();t.preventDefault(),this.menuList&&(t.stopPropagation(),this.move(t.pageX,t.pageY),this.show())}),this.handleGlobalContextMenu=(t=>{this.handleContextMenu(t,"global")}),this.pointerInClient=(t=>{const e=a(this.contextClient),n=e.left+this.contextClient.offsetWidth,i=e.top+this.contextClient.offsetHeight;return e.left<=t.pageX&&t.pageX<=n&&e.top<=t.pageY&&t.pageY<=i}),this.contextClient=t,this.menuData=e||[],this.container=n||document.body,this.menuItemListenerList=[],this.createMenuElement(),this.loadToHtml(),this.initEvent()}createMenuElement(){if(!this.menuData.length)return void(this.menuList=null);const t=document.createElement("ul");t.className=`${p}-root`,t.setAttribute("role","menu"),this.menuData.forEach(e=>{const n=document.createElement("li");n.className=`${p}-item`;const i=void 0===e.disabled||!!e.disabled;i&&n.classList.add("disabled"),n.setAttribute("role","menuitem");const r=document.createElement("span");r.className=`${p}-item-text`,"string"==typeof e.text?r.innerText=e.text:r.appendChild(e.text),n.appendChild(r),i||n.addEventListener("click",e.onClick),this.menuItemListenerList.push(()=>{n.removeEventListener("click",e.onClick)}),t.appendChild(n)});const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.width="100%";const n=document.createElement("div");n.className=`${p}-wrapper ${p}-hidden`,n.appendChild(t),e.appendChild(n),this.menuList=t,this.dropdownDiv=n,this.topDiv=e}loadToHtml(){this.menuData.length&&this.container.appendChild(this.topDiv)}initEvent(){this.contextClient.addEventListener("contextmenu",this.handleContextMenu),window.addEventListener("contextmenu",this.handleGlobalContextMenu),window.addEventListener("click",this.handleWindowClick)}removeEvent(){window.removeEventListener("click",this.handleWindowClick),window.removeEventListener("contextmenu",this.handleGlobalContextMenu),this.contextClient.removeEventListener("contextmenu",this.handleContextMenu),this.menuItemListenerList.forEach(t=>t()),this.menuItemListenerList=[]}}const m="scratchcard-content",b={callback:()=>{},size:{width:300,height:150},sizeAdaption:!0,finishedThreshold:.5,fontFamily:"serif",fontSize:"14px",coating:"#b5b5b5",autoRefreshScratchedPercent:!0,menuContainer:document.body};class g{constructor(t,e,n){this.resizeCanvas=(t=>{for(const e of t){const t=e.target;t===this.container&&(this.cwidth=t.clientWidth,this.cheight=t.clientHeight,this.canvas.width=this.cwidth,this.canvas.height=this.cheight,this.initCard(),this.relocateCanvas())}}),this.clear=(()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}),this.setCoating=(t=>new Promise((e,n)=>{const i=t||this.options.coating;c(i)?h(i).then(t=>{this.ctx.drawImage(t,0,0,this.canvas.width,this.canvas.height),e()},n):!function(t){return t instanceof CanvasGradient||"string"==typeof t&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(t)}(i)?i instanceof HTMLImageElement?(i.crossOrigin="",this.ctx.drawImage(i,0,0,this.canvas.width,this.canvas.height),e()):n(new Error(`"${t}", this type of coating is not supported`)):(this.ctx.fillStyle=i,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),e())})),this.setBackground=(t=>{if(this.removeAllBackground(),c(t)){const e=document.createElement("img");e.alt="",e.className=m,h(t).then(t=>{e.src=t.src,e.style.visibility="hidden",this.container.appendChild(e)})}else if(t instanceof HTMLImageElement){const e=document.createElement("img");e.alt="",e.className=m,e.src=t.src,e.style.visibility="hidden",this.container.appendChild(e)}else if("string"==typeof t){this.ctx.font=`${this.options.fontSize} ${this.options.fontFamily}`;const e=document.createElement("div"),n=document.createElement("span");n.innerText=t,n.className=`${m}-text`,e.className=m,e.appendChild(n),e.style.visibility="hidden",this.container.appendChild(e)}else t.classList.add(m),t.style.visibility="hidden",this.container.appendChild(t)}),this.handleMouseMove=(t=>{if(t.preventDefault(),1!==l(t))return;const e=this.getMousePos(t);this.brush.moveBrushPos(e.x,e.y),this.scrach(),this.options.autoRefreshScratchedPercent&&this.updateScratchedPercent()}),this.getMousePos=(t=>{let e,n;return"mousemove"===t.type?(e=t.clientX,n=t.clientY):"touchmove"===t.type&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{x:e-this.canvasPos.left,y:n-this.canvasPos.top}}),this.scrach=(()=>{this.ctx.globalCompositeOperation="destination-out",this.ctx.save(),this.brush.brush(),this.ctx.restore()}),this.relocateCanvas=(()=>{this.canvasPos=a(this.canvas)}),this.removeAllBackground=(()=>{const t=this.container.querySelectorAll(`.${m}`);[].forEach.call(t,function(t){t.remove()})}),this.showBackground=(()=>{const t=this.container.querySelectorAll(`.${m}`);[].forEach.call(t,function(t){t.style.visibility="visible"})}),this.updateScratchedPercent=(()=>{const t=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data,e=t.length;let n=0;for(let i=0;i<e;i+=4)0===t[i]&&0===t[i+1]&&0===t[i+2]&&0===t[i+3]&&n++;this.scratchedPercent=n>0?n/(this.canvas.width*this.canvas.height):0}),this.triggerFinished=(()=>{this.options.callback&&this.options.callback()}),this.setContextMenu=(t=>{this.contextMenu.reCreateMenu(t)}),this.enableAllMenu=(()=>{const t=this.menuData.length;for(let e=0;e<t;e++)this.menuData[e].disabled=!1}),this.options=Object.assign({},b,e,{fontSize:s(e.fontSize)||b.fontSize}),this.container=t,this.scratchedPercent=0,this.alreadyRefreshContextMenu=!1,this.options.sizeAdaption?(this.cwidth=this.container.clientWidth,this.cheight=this.container.clientHeight):(this.cwidth=this.options.size.width,this.cheight=this.options.size.height),this.updateScratchedPercent=r()(this.updateScratchedPercent,16),this.setBackground(this.options.content),this.createCanvas(),this.brush=new f(this.ctx),this.initCard(),this.initEvent(),this.cRO=new o.a(this.resizeCanvas),this.cRO.observe(this.container),this.menuData=[...n],this.contextMenu=new v(this.canvas,this.menuData,this.options.menuContainer)}createCanvas(){this.canvas=document.createElement("canvas"),this.canvas.tabIndex=0,this.canvas.width=this.cwidth,this.canvas.height=this.cheight,this.container.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.relocateCanvas()}initCard(){this.clear(),this.setCoating(this.options.coating).then(this.showBackground,t=>{throw t})}initEvent(){const t=this;let e,n,i;u()?(e="touchstart",n="touchend",i="touchmove"):(e="mousedown",n="mouseup",i="mousemove"),this.canvas.addEventListener(e,function(e){e.preventDefault(),t.canvas.addEventListener(i,t.handleMouseMove),document.body.addEventListener(n,function e(r){t.canvas.removeEventListener(i,t.handleMouseMove),document.body.removeEventListener(n,e),t.options.autoRefreshScratchedPercent||t.updateScratchedPercent(),t.scratchedPercent>t.options.finishedThreshold&&(t.alreadyRefreshContextMenu||(t.alreadyRefreshContextMenu=!0,t.enableAllMenu(),t.contextMenu.reCreateMenu(t.menuData)),1===l(r)&&t.triggerFinished())})}),window.addEventListener("scroll",r()(this.relocateCanvas,16)),window.addEventListener("resize",r()(this.relocateCanvas,16))}}window.ScratchCardEpic=g;e.default=g}])});